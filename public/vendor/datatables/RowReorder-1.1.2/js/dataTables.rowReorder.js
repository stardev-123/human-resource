/*! RowReorder 1.1.2
 * 2015-2016 SpryMedia Ltd - datatables.net/license
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net"],function(b){return a(b,window,document)})}else{if(typeof exports==="object"){module.exports=function(b,c){if(!b){b=window}if(!c||!c.fn.dataTable){c=require("datatables.net")(b,c).$}return a(c,b,b.document)}}else{a(jQuery,window,document)}}}(function(e,c,a,f){var d=e.fn.dataTable;var b=function(j,i){if(!d.versionCheck||!d.versionCheck("1.10.8")){throw"DataTables RowReorder requires DataTables 1.10.8 or newer"}this.c=e.extend(true,{},d.defaults.rowReorder,b.defaults,i);this.s={bodyTop:null,dt:new d.Api(j),getDataFn:d.ext.oApi._fnGetObjectDataFn(this.c.dataSrc),middles:null,scroll:{},scrollInterval:null,setDataFn:d.ext.oApi._fnSetObjectDataFn(this.c.dataSrc),start:{top:0,left:0,offsetTop:0,offsetLeft:0,nodes:[]},windowHeight:0};this.dom={clone:null,dtScroll:e("div.dataTables_scrollBody",this.s.dt.table().container())};var h=this.s.dt.settings()[0];var g=h.rowreorder;if(g){return g}h.rowreorder=this;this._constructor()};e.extend(b.prototype,{_constructor:function(){var i=this;var h=this.s.dt;var g=e(h.table().node());if(g.css("position")==="static"){g.css("position","relative")}e(h.table().container()).on("mousedown.rowReorder touchstart.rowReorder",this.c.selector,function(k){var j=e(this).closest("tr");if(h.row(j).any()){i._mouseDown(k,j);return false}});h.on("destroy.rowReorder",function(){e(h.table().container()).off(".rowReorder");h.off(".rowReorder")})},_cachePositions:function(){var j=this.s.dt;var g=e(j.table().node()).find("thead").outerHeight();var h=e.unique(j.rows({page:"current"}).nodes().toArray());var k=e.map(h,function(m,l){return e(m).position().top-g});var i=e.map(k,function(m,l){return k.length<l-1?(m+k[l+1])/2:(m+m+e(j.row(":last-child").node()).outerHeight())/2});this.s.middles=i;this.s.bodyTop=e(j.table().body()).offset().top;this.s.windowHeight=e(c).height()},_clone:function(k){var j=this.s.dt;var l=e(j.table().node().cloneNode(false)).addClass("dt-rowReorder-float").append("<tbody/>").append(k.clone(false));var g=k.outerWidth();var h=k.outerHeight();var i=k.children().map(function(){return e(this).width()});l.width(g).height(h).find("tr").children().each(function(m){this.style.width=i[m]+"px"});l.appendTo("body");this.dom.clone=l},_clonePosition:function(j){var l=this.s.start;var h=this._eventToPage(j,"Y")-l.top;var k=this._eventToPage(j,"X")-l.left;var g=this.c.snapX;var i;if(g===true){i=l.offsetLeft}else{if(typeof g==="number"){i=l.offsetLeft+g}else{i=k+l.offsetLeft}}this.dom.clone.css({top:h+l.offsetTop,left:i})},_emitEvent:function(h,g){this.s.dt.iterator("table",function(j,k){e(j.nTable).triggerHandler(h+".dt",g)})},_eventToPage:function(g,h){if(g.type.indexOf("touch")!==-1){return g.originalEvent.touches[0]["page"+h]}return g["page"+h]},_mouseDown:function(k,j){var i=this;var h=this.s.dt;var m=this.s.start;var l=j.offset();m.top=this._eventToPage(k,"Y");m.left=this._eventToPage(k,"X");m.offsetTop=l.top;m.offsetLeft=l.left;m.nodes=e.unique(h.rows({page:"current"}).nodes().toArray());this._cachePositions();this._clone(j);this._clonePosition(k);this.dom.target=j;j.addClass("dt-rowReorder-moving");e(a).on("mouseup.rowReorder touchend.rowReorder",function(n){i._mouseUp(n)}).on("mousemove.rowReorder touchmove.rowReorder",function(n){i._mouseMove(n)});if(e(c).width()===e(a).width()){e(a.body).addClass("dt-rowReorder-noOverflow")}var g=this.dom.dtScroll;this.s.scroll={windowHeight:e(c).height(),windowWidth:e(c).width(),dtTop:g.length?g.offset().top:null,dtLeft:g.length?g.offset().left:null,dtHeight:g.length?g.outerHeight():null,dtWidth:g.length?g.outerWidth():null}},_mouseMove:function(n){this._clonePosition(n);var k=this._eventToPage(n,"Y")-this.s.bodyTop;var o=this.s.middles;var j=null;var h=this.s.dt;var m=h.table().body();for(var l=0,p=o.length;l<p;l++){if(k<o[l]){j=l;break}}if(j===null){j=o.length}if(this.s.lastInsert===null||this.s.lastInsert!==j){if(j===0){this.dom.target.prependTo(m)}else{var g=e.unique(h.rows({page:"current"}).nodes().toArray());if(j>this.s.lastInsert){this.dom.target.insertAfter(g[j-1])}else{this.dom.target.insertBefore(g[j])}}this._cachePositions();this.s.lastInsert=j}this._shiftScroll(n)},_mouseUp:function(y){var u=this.s.dt;var x,g;var r=this.c.dataSrc;this.dom.clone.remove();this.dom.clone=null;this.dom.target.removeClass("dt-rowReorder-moving");e(a).off(".rowReorder");e(a.body).removeClass("dt-rowReorder-noOverflow");clearInterval(this.s.scrollInterval);this.s.scrollInterval=null;var t=this.s.start.nodes;var q=e.unique(u.rows({page:"current"}).nodes().toArray());var l={};var s=[];var m=[];var p=this.s.getDataFn;var h=this.s.setDataFn;for(x=0,g=t.length;x<g;x++){if(t[x]!==q[x]){var v=u.row(q[x]).id();var w=u.row(q[x]).data();var k=u.row(t[x]).data();if(v){l[v]=p(k)}s.push({node:q[x],oldData:p(w),newData:p(k),newPosition:x,oldPosition:e.inArray(q[x],t)});m.push(q[x])}}var n=[s,{dataSrc:r,nodes:m,values:l,triggerRow:u.row(this.dom.target)}];this._emitEvent("row-reorder",n);if(this.c.editor){this.c.editor.edit(m,false,{submit:"changed"}).multiSet(r,l).submit()}if(this.c.update){for(x=0,g=s.length;x<g;x++){var j=u.row(s[x].node);var o=j.data();h(o,s[x].newData);u.columns().every(function(){if(this.dataSrc()===r){u.cell(s[x].node,this.index()).invalidate("data")}})}this._emitEvent("row-reordered",n);u.draw(false)}},_shiftScroll:function(l){var k=this;var g=this.s.dt;var o=this.s.scroll;var n=false;var m=5;var i=65;var p=l.pageY-a.body.scrollTop,h,j;if(p<i){h=m*-1}else{if(p>o.windowHeight-i){h=m}}if(o.dtTop!==null&&l.pageY<o.dtTop+i){j=m*-1}else{if(o.dtTop!==null&&l.pageY>o.dtTop+o.dtHeight-i){j=m}}if(h||j){o.windowVert=h;o.dtVert=j;n=true}else{if(this.s.scrollInterval){clearInterval(this.s.scrollInterval);this.s.scrollInterval=null}}if(!this.s.scrollInterval&&n){this.s.scrollInterval=setInterval(function(){if(o.windowVert){a.body.scrollTop+=o.windowVert}if(o.dtVert){var q=k.dom.dtScroll[0];if(o.dtVert){q.scrollTop+=o.dtVert}}},20)}}});b.defaults={dataSrc:0,editor:null,selector:"td:first-child",snapX:false,update:true};b.version="1.1.2";e.fn.dataTable.RowReorder=b;e.fn.DataTable.RowReorder=b;e(a).on("init.dt.dtr",function(k,h,g){if(k.namespace!=="dt"){return}var l=h.oInit.rowReorder;var j=d.defaults.rowReorder;if(l||j){var i=e.extend({},l,j);if(l!==false){new b(h,i)}}});return b}));
